#  MAC-адреса сетевых устройств

------------

#### Топология

[![2024-03-18-23-28-00.png](https://i.postimg.cc/vBtbZS4f/2024-03-18-23-28-00.png)](https://postimg.cc/MMHhs5bp)

###  Задание:
###### **Часть 1. Создание и настройка сети** 

- Тестирование настроенных конфигураций

###### **Часть 2. Изучение таблицы MAC-вдресов коммутатора**

- отправка ЭХО-запросов устройствам
- оценка построения устрайствами MAC-адресов


### Общие сведения/сценарий


 
 
 Коммутаторы используются для соединения компьютеров в локальных сетях (LAN) и передачи данных между ними. Коммутаторы отправляют кадры Ethernet на узловые устройства, которые идентифицируются по МАС-адресам сетевых плат.

 Коммутатор локальной сети на уровне 2 предназначен для доставки кадров Ethernet всем узловым устройствам в локальной сети (LAN). Он записывает МАС-адреса узлов, отображаемые в сети, и сопоставляет их с собственными портами коммутатора Ethernet. Этот процесс называется созданием таблицы МАС-адресов.

 В первой части работы, мы построим топологию, состоящую из двух коммутаторов, соединенных транком. В части 2 отправим эхо-запросы различным устройствам и посмотрим, как два коммутатора строят свои таблицы МАС-адресов.
 
 __Примечание__. В лабораторной работе используются коммутаторы Cisco Catalyst 2960s с операционной системой Cisco IOS 15.2(2) (образ lanbasek9). Допускается использование других моделей коммутаторов и других версий Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах.
 
 __Примечание__. Убедитесь, что все настройки коммутатора удалены и загрузочная конфигурация отсутствует.
 
### Необхлжимые ресурсы

- 2 коммутатора (Cisco 2960 с операционной системой Cisco IOS 15.2(2) (образ lanbasek9) 
- 2  ПК (Windows и программа эмуляции терминала, такая как Tera Term)
- Консольные кабели для настройки устройств Cisco IOS через консольные порты
- Кабели Ethernet, расположенные в соответствии с топологией


 ### Часть 1. Создание и настройка сети
 #### Шаг 1. Подключаем сеть в соответствии с топологией.

 #### Шаг 2. Настраиваем узлы ПК.
 Для этого заходим в настройку устройства задаем имя компьютера:

 [![2024-03-18-18-32-10.png](https://i.postimg.cc/mZJVCV1M/2024-03-18-18-32-10.png)](https://postimg.cc/140pZGH5)

IP адрес и маску подсити:

[![2024-03-18-18-32-31.png](https://i.postimg.cc/6pj84byx/2024-03-18-18-32-31.png)](https://postimg.cc/dhCszB25)

 #### Шаг 3. Выполняем инициализацию и перезагрузку коммутаторов.
 Для чего подключаем коммутатор по консольному кабелю к ПК и входим в настройки используя Terminal. Из привелегированного режима вводим команду __reload__

 ```
Switch>
Switch>
Switch>en
Switch#
Switch#
Switch#
Switch#re
Switch#rel
Switch#reload 
 ```


 #### Шаг 4. Настраиваем базовые параметры каждого коммутатора.

- Настраиваем имена устройств в соответствии с топологией.

Для начала настраиваем Display name 

[![2024-03-18-18-53-11.png](https://i.postimg.cc/159q2qFX/2024-03-18-18-53-11.png)](https://postimg.cc/23KyB32N)

Затем, переходим в коммандную строку и из режима глобальной конфигурации настраиваем имя Хоста

``` 
Switch>
Switch>en
Switch#
Switch#
Switch#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
Switch(config)#
Switch(config)#hostna
Switch(config)#hostname S1
S1(config)#
S1(config)#
```
На втором коммутаторе производим те же операции.


- Настраиваем IP-адреса, как указано в таблице адресации.

|      Устройство  |        Интерфейс   |         IP-адрес    |         Маска подсети     |
|:----------------:|--------------------|:-------------------:|:-------------------------:|
|     S1           |        VLAN 1      |     192.168.1.11    |        255.255.255.0      |
|     S2           |        VLAN 1      |     192.168.1.12    |        255.255.255.0      |
|     PC-A         |         NIC        |      192.168.1.1    |        255.255.255.0      |
|     PC-B         |         NIC        |      192.168.1.2    |        255.255.255.0      |


Заходим в коммутаторы по очереди через терминал и настраиваем адрес в режиме глобальной конфигурации:

```
S1(config)#interface vlan1
S1(config-if)#
S1(config-if)#ip add
S1(config-if)#ip address 192.168.1.11 255.255.255.0
S1(config-if)#
S1(config-if)#no sh
S1(config-if)#no shutdown 
S1(config-if)#
%LINK-5-CHANGED: Interface Vlan1, changed state to up

S1(config-if)#
```
Настроим пароль __cisco__ для консольного порта? так же из режима глобальной конфигурации введя командц __line console 0__

```
S1(config)#line console 0 
S1(config-line)#
S1(config-line)#
S1(config-line)#pass
S1(config-line)#password cisco
S1(config-line)#
S1(config-line)#login
S1(config-line)#
```
Установим ограничение на привелегированный режим паролем __cisco__

```
S1(config)#enabl
S1(config)#enable sec
S1(config)#enable secret cisco
S1(config)#
```
Установим пароль для виртуального доступа к коммутатору __VTY__ 

```
S1(config)#
S1(config)#line vty 0 4
S1(config-line)#
S1(config-line)#pass
S1(config-line)#password class
S1(config-line)#
S1(config-line)#log
S1(config-line)#login
S1(config-line)#
```
 а так же разрешим подключение к нему по протоколу __Telnet__

```
S1(config-line)#
S1(config-line)#trans
S1(config-line)#transport inp
S1(config-line)#transport input tel
S1(config-line)#transport input telnet 
S1(config-line)#
```
Все созданные нами пароли лучше скрыть от непреднамеренного копирования. Для этого зашифруем их коммандой __service password-encryption__

```
S1(config)#service pass
S1(config)#service password-encryption 
S1(config)#
```
Сохраним настройки в стартовую конфигурацию 

```
S1#copy running-config startup-config 
Destination filename [startup-config]? 
Building configuration...
[OK]
S1#
```
Выведя стартовую конфигурацию устройства видим что IP адрес присвоен и доступ посторонним ограничен

```
!
interface Vlan1
 ip address 192.168.1.11 255.255.255.0
!
!
!
!
line con 0
 password 7 0822455D0A16
 login
!
line vty 0 4
 password 7 0822404F1A0A
 login
```

Данные операции проделываем со всеми уоммутаторами сети.

###  Часть 2. Изучение таблицы MAC-адресов коммутатора
Как только между сетевыми устройствами начинается передача данных, коммутатор выясняет МАС-адреса и строит таблицу.

#### Шаг 1. Запишем МАС-адреса сетевых устройств

  а. В коммандной строке PC-A вводим комманду __ipconfig /all.__. В выведенном файле строка __phisical address__ является mac-адресом устройства

  [![2024-03-18-21-42-44.png](https://i.postimg.cc/ydBj1qTB/2024-03-18-21-42-44.png)](https://postimg.cc/cK9whbj5)

В коммандной строке PC-В проводим ту же операцию

[![2024-03-18-21-48-40.png](https://i.postimg.cc/nVKzjyYg/2024-03-18-21-48-40.png)](https://postimg.cc/Yj9kTyPz)


  b.  Подключемся к коммутатору S1 через консоль и введя команду __show interface fa0/1__ в 3-ей строке находим MAC-адрес оборудования 

 ```
 S1#show interfaces fa0/1
FastEthernet0/1 is up, line protocol is up (connected)
  Hardware is Lance, address is 0050.0f18.4e01 (bia 0050.0f18.4e01)
 BW 100000 Kbit, DLY 1000 usec,
   
 ```
 Переключившись на терминал коммутатора S2 производим те же операции 

 ```
S2#show interfaces fa0/1
FastEthernet0/1 is down, line protocol is down (disabled)
  Hardware is Lance, address is 000c.8564.5901 (bia 000c.8564.5901)
 BW 100000 Kbit, DLY 1000 usec,
 ```

запоминаем данные MAC-адреса устройств


#### Шаг 2. Анализ таблицы МАС-адресов коммутатора.
Подключившись к коммутатору S2 через консоль посмотрим таблицу МАС-адресов до и после тестирования сетевой связи с помощью эхо-запросов.

- Подключившись к комутатору S2 через консоль, войдем в привелигированный режим EXEC и выведем таблицу командой __show mac address-table__

```
Password: 
S2#
S2#show int
S2#show mac address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0001.c72b.dee4    DYNAMIC     Fa0/18
   1    0050.0f18.4e01    DYNAMIC     Fa0/1
   1    0090.213e.2ae8    DYNAMIC     Fa0/1
S2#
```
Мы видим что в данной таблице указаны MAC адрес следующего коммутатора S1 подключенного к порту 1 и компьютера подключенного к порту 18. Третий адрес принадлежит сетевой плате нашего устройства.

Если вы не записали MAC адреса на предыдущем шаге, то данной командой можно определить, какие из устройств находятся рядом с просматриваемым коммутатором, так как устройства всегда опрашивают свои подключения.

#### Шаг 3. Очистим таблицу MAC-адресов коммутатора S2 и снова ее выведем.

- В привелигированном режиме введем команду __clear mac address-table dynamic__ и нажмем клавишу __enter__

```
S2#
S2#clear mac address-table dynamic
S2#
```
 - Теперь снова сразу выведем таблицу коммандой __show mac address-table__

 ```
SS2#
S2#show mac address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

 ```
Таблица пуста

Через 10 сек вводим комманду __show mac address-table___

```
S2#show mac address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0050.0f18.4e01    DYNAMIC     Fa0/1
S2#
```
И мы видим, что появился рядом стоящий коммутатор S1

### Шаг 4. С компьютера PC-B отправим эхо-запросы устройствам в сети и просмотрим таблицу МАС-адресов коммутатора

  - На компьютере PC-B откроем командную строку и введем команду arp -a

  [![2024-03-18-22-58-06.png](https://i.postimg.cc/tJrNN2Vx/2024-03-18-22-58-06.png)](https://postimg.cc/D4XG2Q6v)


Мы видим, что не считая адресов многоадресной и широковещательной рассылки, через протокол ARP было получено 3 пары IP- и МАС-адресов устройств.

  - Из коммандной строки PC-B отправляем эхо-запросы на компьютер PC-A, а также коммутаторы S1 и S2.

[![2024-03-18-23-08-51.png](https://i.postimg.cc/Z5rtVdVq/2024-03-18-23-08-51.png)](https://postimg.cc/RWVD0Nrr)

В данном отчете мы видим, что ответ от всех устройств без потерь пакетов

 - Подключившись через консоль к коммутатору S2, вводим команду __show mac address-table__

 ```
S2#
S2#show mac address-table
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   1    0001.c72b.dee4    DYNAMIC     Fa0/18
   1    0002.16b9.b713    DYNAMIC     Fa0/1
   1    0050.0f18.4e01    DYNAMIC     Fa0/1
   1    0090.213e.2ae8    DYNAMIC     Fa0/1
S2#
 ```


 Видим, что в сети есть 3 устройства помимо нашего 

  -  на компьютере PC-B откроем командную строку и еще раз введем команду arp -a

 [![2024-03-18-23-17-27.png](https://i.postimg.cc/kX5WQ0F1/2024-03-18-23-17-27.png)](https://postimg.cc/14LgPYdw)


 В получившейся записи кэша мы видим, что дополнительных устройств в сети, сверх того что были ранее, не появилось.


В сетях Ethernet данные передаются на устройства по соответствующим МАС-адресам. Для этого коммутаторы и компьютеры динамически создают ARP-кэш и таблицы МАС-адресов. Если компьютеров в сети немного, эта процедура выглядит достаточно простой. Однако если сетевых устройств намного больше, то понять какие именно устройства мы видим за портами следующих коммутаторов, будет проблематично, подключившись только к одному коммутатору.







